select round((SUM(case case_status when 'CERTIFIED' then 1 end)/count(case_status))*100,2) as CERTIFIED, round((SUM(case case_status when 'CERTIFIED-WITHDRAWN' then 1 end)/count(case_status))*100,2) as CERTIFIED_WITHDRAWN, round((SUM(case case_status when 'WITHDRAWN' then 1 end)/count(case_status))*100,2) as WITHDRAWN, round((SUM(case case_status when 'DENIED' then 1 end)/count(case_status))*100,2) as DENIED, year from h1b_final group by year order by year;
